version: '2.1'
volumes:
  projects: 
  settings: 
services:
  connector:
    build: ./connector
    privileged: true
    restart: always
    network_mode: host
    ports:
      - 8080:8080
    volumes:
      - projects:/app
    labels:
      io.balena.features.balena-api: '1'
      io.balena.features.supervisor-api: '1'
    environment:
      - AZURE_EH_CONSUMER_GROUP="$Default"
      - AZURE_EH_STORAGE_ACCOUNT="cloudblockstorage"
      - AZURE_EH_CONTAINER_NAME="eventhub"
      - AZURE_EH_STORAGE_ACCOUNT_KEY="DEV"
      - AZURE_EH_CONNECTIONSTRING="DEV"
      - DEBUG="false"
      - MQTT_INPUT_SERVER="tcp://localhost:1883"
  mqtt:
    image: eclipse-mosquitto@sha256:307430eaf1e09ee4b7c8dbcd8303545be06431ee35fe43a9abff33d0fc992579
    ports:
      - "1883:1883"
    restart: always
